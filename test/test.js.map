{"version":3,"sources":["test.ts"],"names":[],"mappings":"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","file":"test.js","sourcesContent":["/// <reference path=\"../typings/main.d.ts\" />\r\nimport * as sc from '../lib/index';\r\nimport request=require('superagent');\r\nimport * as express from 'express';\r\nimport * as chai from 'chai';\r\nimport * as http from 'http';\r\nconst expect= chai.expect;\r\nconst POST=31241;\r\n\r\ndescribe('Site container', () => {\r\n    let server:http.Server;\r\n    beforeEach(done=> {\r\n        const app=sc.site_container_create(\"./site\");\r\n        server=app.listen(POST,done);\r\n    });\r\n    afterEach(()=>{\r\n        server.close(); \r\n    });\r\n    describe('domains', () => {\r\n        it('should get default file for  http://www.test.com/', (done) => {\r\n            request.get(`http://localhost:${POST}/`).set(\"Host\",\"www.test.com\").end((e,r)=>{\r\n                console.log(r.text);\r\n               expect(r.text).contains(\"hello from www.test.com\");\r\n               done(e);\r\n            });\r\n        });\r\n        it('should get default file for  http://test.com/', (done) => {\r\n            request.get(`http://localhost:${POST}/`).set(\"Host\",\"test.com\").end((e,r)=>{\r\n               expect(r.text).contains(\"hello from www.test.com\");\r\n               done(e);\r\n            });\r\n        });\r\n        \r\n        it('should get file by full uri http://www.test.com/index.htm', (done) => {\r\n            request.get(`http://localhost:${POST}/index.htm`).set(\"Host\",\"www.test.com\").end((e,r)=>{\r\n               expect(r.text).contains(\"hello from www.test.com\");\r\n               done(e);\r\n            });\r\n        });\r\n        \r\n        it('should get default file for  http://test.com/subfolder/', (done) => {\r\n            request.get(`http://localhost:${POST}/subfolder/`).set(\"Host\",\"test.com\").end((e,r)=>{\r\n               expect(r.text).contains(\"hello subfolder from www.test.com\");\r\n               done(e);\r\n            });\r\n        });        \r\n        it('should get file by full uri http://www.test.com/subfolder/index.htm', (done) => {\r\n            request.get(`http://localhost:${POST}/subfolder/index.htm`).set(\"Host\",\"www.test.com\").end((e,r)=>{\r\n               expect(r.text).contains(\"hello subfolder from www.test.com\");\r\n               done(e);\r\n            });\r\n        });\r\n        \r\n         it('should get file by localhost uri http://locahost/', (done) => {\r\n            request.get(`http://localhost:${POST}/`).end((e,r)=>{\r\n               expect(r.text).contains(\"hello from localhost\");\r\n               done(e);\r\n            });\r\n        });\r\n    });\r\n});"]}